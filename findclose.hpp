#ifndef SUCCINCT_TRIES__FINDCLOSE_HPP_
#define SUCCINCT_TRIES__FINDCLOSE_HPP_

#include <cstdint>
#include <x86intrin.h>
#include <cassert>
#include <iostream>
#include <bitset>

namespace strie {

// popcount
constexpr int8_t PC_TB[1<<8] {
    0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,
    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,
    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,
    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,
    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,
    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,
    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,
    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,
    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,
    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,
    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,
    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,
    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,
    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,
    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,
    4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8,
};
// '(': 0, ')': 1
constexpr int8_t FINDCLOSE_TB[1<<8][15] { // [bitmask][#'(']
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 8, 8, 8, 8 },
    { 8, 8, 8, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 8, 8, 8 },
    { 8, 8, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 8, 8, 8, 8 },
    { 8, 8, 8, 4, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 5, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 5, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 5, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 5, 8, 8 },
    { 8, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 8, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 8, 8, 8, 8 },
    { 8, 8, 8, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 8, 8, 8 },
    { 8, 8, 5, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 6, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 6, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 6, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 6, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 6, 8, 8, 8 },
    { 8, 8, 8, 4, 5, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 5, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 1, 6, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 5, 6, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 5, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 5, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 5, 6, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 5, 6, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 5, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 5, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 5, 6, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 5, 6, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 5, 6, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 5, 6, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 5, 6, 8 },
    { 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 7, 8, 8, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 7, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 7, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 7, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 7, 8, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 7, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 2, 3, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 7, 0, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 8, 8, 8, 8 },
    { 8, 8, 7, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 4, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 4, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 7, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 7, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 7, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 8, 8, 8 },
    { 8, 8, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 8, 8, 8, 8 },
    { 8, 8, 8, 4, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 5, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 5, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 5, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 5, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 5, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 5, 8, 8 },
    { 8, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 7, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 7, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 7, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 7, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 7, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 1, 2, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 6, 3, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 3, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 6, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 8, 8, 8, 8 },
    { 8, 8, 8, 4, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 7, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 7, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 7, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 7, 8, 8 },
    { 8, 8, 5, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 6, 7, 0, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 6, 1, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 1, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 5, 2, 7, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 5, 0, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 3, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 6, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 6, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 6, 7, 8, 8 },
    { 8, 8, 8, 4, 5, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 5, 0, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 4, 1, 6, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 5, 6, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 5, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 5, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 5, 6, 7, 8, 8 },
    { 8, 8, 8, 8, 3, 4, 5, 6, 7, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 3, 0, 5, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 4, 5, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 4, 5, 6, 7, 8, 8 },
    { 8, 8, 8, 8, 8, 2, 3, 4, 5, 6, 7, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 3, 4, 5, 6, 7, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 1, 2, 3, 4, 5, 6, 7, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 0, 1, 2, 3, 4, 5, 6, 7 },
};
// '(': 0, ')': 1
constexpr int8_t FINDDEPTHR_TB[1<<8][15]{ // [bitmask][#'(']
    { 6, 5, 4, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 6, 5, 4, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 7, 4, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 5, 4, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 7, 6, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 6, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 4, 7, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 4, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 7, 6, 5, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 6, 5, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 5, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 3, 6, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 3, 2, 7, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 3, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 7, 6, 5, 4, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 6, 5, 4, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 4, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 5, 4, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 7, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 2, 7, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 2, 5, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 2, 7, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 2, 1, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 2, 1, 0, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 2, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 7, 6, 5, 4, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 6, 5, 4, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 4, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 5, 4, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 7, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 0, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 4, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 0, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 0, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 0, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 0, 8, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 0, 8, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 1, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 7, 6, 5, 4, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 6, 5, 4, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 4, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 5, 4, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 7, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 2, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 8, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 8, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 3, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 3, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 7, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 4, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 7, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 8, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 8, 7, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 8, 8, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 8, 8, 8, 7, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 0, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 7, 6, 5, 4, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 6, 5, 4, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 4, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 5, 4, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 7, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 4, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 6, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 2, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 3, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 4, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 4, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 4, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 4, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 1, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 1, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 2, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 5, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 3, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 3, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 3, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 4, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 8, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 8, 7, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 7, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 7, 6, 5, 4, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 6, 5, 4, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 4, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 5, 4, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 7, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 4, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 5, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 3, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 3, 2, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 3, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 5, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 4, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 4, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 2, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 2, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 2, 7, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 7, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 7, 6, 5, 4, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 6, 5, 4, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 4, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 5, 4, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 6, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 4, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 4, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 6, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 5, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 3, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 3, 8, 7, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 3, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 4, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 6, 5, 4, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 4, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 5, 4, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 4, 7, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 4, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 5, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 5, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
    { 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8 },
};
constexpr unsigned FCOFFSET = 6;

unsigned findclose16(const uint16_t w) {
  auto in = FINDCLOSE_TB[w & 0xFF][6];
  if (in < 8)
    return in;
  int acc = PC_TB[w & 0xFF] << 1;
  auto s = 8 - acc;
  if (-6 <= s)
    return 8 + FINDCLOSE_TB[w >> 8][s + 6];
  return 16;
}

unsigned finddepthr16(const uint16_t w, const int depth) {
  int acc = PC_TB[w >> 8] << 1;
  auto s = -depth + 8 - acc;
  if (-6 <= s and s <= 8) {
    auto lead = FINDDEPTHR_TB[w & 0xFF][s + 6];
    if (lead < 8)
      return 8 + lead;
  }
  if (-6 <= -depth and -depth <= 8) {
    auto lead = FINDDEPTHR_TB[w >> 8][-depth + 6];
    assert(lead < 8);
    return lead;
  }
  return 16;
}

} // strie

#endif //SUCCINCT_TRIES__FINDCLOSE_HPP_
